<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For You ¬∑ Besto Friendo + final button</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            margin: 0;
            background-color: black;
            color: white;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* ===== MUSIC PLAYER (vinyl style) ===== */
        .music-player {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: auto;
            max-width: 90vw;
            background: rgba(18, 18, 30, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(160, 180, 255, 0.3);
            border-radius: 80px;
            padding: 12px 24px 12px 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 100;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(200, 210, 255, 0.2) inset;
            transition: box-shadow 0.3s;
        }

        .music-player:hover {
            box-shadow: 0 18px 40px rgba(80, 100, 255, 0.3), 0 0 0 1px rgba(210, 220, 255, 0.5) inset;
        }

        .vinyl-container {
            position: relative;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #444, #111);
            box-shadow: 0 5px 15px rgba(0,0,0,0.8), 0 0 0 2px #8a6e4b;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: spin-slow 8s linear infinite;
            animation-play-state: paused;
            flex-shrink: 0;
        }

        .vinyl-label {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: radial-gradient(circle, #ffd966, #b8860b);
            border: 2px solid #f1c40f;
            box-shadow: 0 2px 6px black;
        }

        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .music-player.playing .vinyl-container {
            animation-play-state: running;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .play-pause-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,240,200,0.6);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            line-height: 1;
        }

        .play-pause-btn:hover {
            background: rgba(200, 180, 255, 0.3);
            border-color: #fffaee;
            transform: scale(1.05);
        }

        .play-pause-btn.playing {
            background: rgba(100, 160, 255, 0.4);
            border-color: #aaccff;
        }

        .song-info {
            display: flex;
            flex-direction: column;
            min-width: 120px;
        }

        .song-title {
            font-weight: 600;
            font-size: 1rem;
            color: #ffe9b0;
            letter-spacing: 0.5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 160px;
        }

        .song-artist {
            font-size: 0.75rem;
            color: #a9b7e8;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .progress-area {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #c0c9ff;
            font-size: 0.75rem;
        }

        .time-current, .time-duration {
            min-width: 35px;
            text-align: center;
        }

        .seek-bar {
            width: 140px;
            height: 5px;
            background: rgba(255,255,240,0.2);
            border-radius: 10px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .seek-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #b2c9ff, #f0d99d);
            border-radius: 10px;
            pointer-events: none;
        }

        #audioPlayer {
            display: none;
        }

        @media (max-width: 700px) {
            .music-player {
                flex-wrap: wrap;
                border-radius: 60px;
                padding: 12px 18px;
                gap: 12px;
                top: 10px;
            }
            .progress-area {
                order: 3;
                width: 100%;
                justify-content: center;
            }
            .seek-bar {
                width: 200px;
            }
        }

        /* ===== MAIN TEXT (crossfade layers) ===== */
        #text-container {
            position: relative;
            width: 90%;
            max-width: 900px;
            min-height: 240px;        /* increased to accommodate button */
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 100px;
        }

        .text-layer {
            position: absolute;
            width: 100%;
            text-align: center;
            font-size: 2.2rem;
            line-height: 1.4;
            text-shadow: 0 0 12px rgba(160, 180, 255, 0.7);
            transition: opacity 1s ease-in-out;
            pointer-events: none;      /* base, but button inside will be given pointer-events auto */
            word-break: break-word;
            padding: 0 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        /* special button inside final message */
        .final-link-btn {
            pointer-events: auto;
            background: linear-gradient(135deg, #ffb6c1, #ff69b4);
            border: none;
            border-radius: 60px;
            padding: 14px 32px;
            font-size: 1.3rem;
            font-weight: bold;
            color: #2d0a1a;
            cursor: pointer;
            box-shadow: 0 0 25px #ffa0c5, 0 4px 10px black;
            transition: 0.2s;
            border: 1px solid #ffe2f0;
            text-decoration: none;
            display: inline-block;
            margin-top: 15px;
        }

        .final-link-btn:hover {
            transform: scale(1.08);
            background: linear-gradient(135deg, #ffc0cb, #ff1493);
            box-shadow: 0 0 35px #ffc0db;
        }

        .layer-hidden { opacity: 0; }
        .layer-visible { opacity: 1; }

        .click-hint {
            position: fixed;
            bottom: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            color: #5f6b8f;
            font-size: 0.85rem;
            pointer-events: none;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>

    <!-- MUSIC PLAYER -->
    <div class="music-player" id="customPlayer">
        <div class="vinyl-container" id="vinylDisc">
            <div class="vinyl-label"></div>
        </div>

        <div class="player-controls">
            <div class="play-pause-btn" id="playPauseBtn">‚ñ∂</div>
            <div class="song-info">
                <span class="song-title" id="songTitle">i love you</span>
                <span class="song-artist" id="songArtist">Billie Eilish</span>
            </div>
        </div>

        <div class="progress-area">
            <span class="time-current" id="currentTime">0:00</span>
            <div class="seek-bar" id="seekBar">
                <div class="seek-fill" id="seekFill"></div>
            </div>
            <span class="time-duration" id="durationTime">0:00</span>
        </div>

        <audio id="audioPlayer" loop preload="auto">
            <!-- üîΩ REPLACE THIS WITH YOUR MUSIC FILE üîΩ -->
            <source src="Billie Eilish - i love you (Lyrics).mp3" type="audio/mpeg">
        </audio>
    </div>

    <!-- message container with crossfade layers (two layers for smooth fade) -->
    <div id="text-container">
        <div id="text-layer-a" class="text-layer layer-visible"></div>
        <div id="text-layer-b" class="text-layer layer-hidden"></div>
    </div>

    <div class="click-hint">‚ùù every touch reveals a word ‚ùû</div>

    <script>
        (function() {
            // ---------- MESSAGE LINES (last one includes a placeholder for button) ----------
            const lines = [
                "You clicked.", "So your birthday is today.", "Still here?", "Good.",
                "I made this just for you.", "And yes...",
                "You more important than anything (for me btw)", "We met in 10/01/2024",
                "it's been 2 years right?", "What a fantastic friendship",
                "So today is 31/05/2026, You grow up", "What a day!!", "31/05/2010", "The day when a beautiful white heart girl is borned",
                "I'll always be grateful to your mom and dad, because without them, I wouldn't have you",
                "Thanks for them", "so..", "Me and you",
                "Like we were in Blade Runner", "Like Joe talks with his virtual girl Joi",
                "There is a button on the last word showed you why i descriped you as a virtual girl",
                "I just wanna say --Thank You!!--", "Thanks For choosing me as your best person",
                "Thank you for your patience with my craziness.", "Thanks for your caring",
                "Thanks for the comedy words", "Thanks for you being my Joi",
                "The electronic friend", "The caring friend", "The girl that comes from heaven",
                "May allah saved you for me!", "Before you go", "KNBGHK", "Made with love by reda to khadija", "You can leave the page"
            ];

            // ---------- CONFIG: FINAL BUTTON LINK ----------
            const FINAL_REDIRECT_URL = "https://cosmic-haupia-2abfbc.netlify.app/"; // <-- SET YOUR LINK HERE

            // ---------- CROSSFADE LOGIC ----------
            let index = 0;
            const layerA = document.getElementById('text-layer-a');
            const layerB = document.getElementById('text-layer-b');
            let activeLayer = 'A';

            // helper to create text content (plain string OR final html with button)
            function buildContentForLine(lineIdx) {
                const lineText = lines[lineIdx];
                // if it's the last line (index = lines.length-1) we insert a button below
                if (lineIdx === lines.length - 1) {
                    return `
                        <div>${lineText}</div>
                        <button class="final-link-btn" id="dynamicFinalBtn">See why!</button>
                    `;
                } else {
                    return lineText; // plain text for others
                }
            }

            // initialize layers
            layerA.innerHTML = buildContentForLine(0);
            if (lines[1]) layerB.innerHTML = buildContentForLine(1);

            function showNextLine() {
                if (index >= lines.length - 1) return; // no more lines
                const nextIndex = index + 1;
                const nextHtml = buildContentForLine(nextIndex);

                if (activeLayer === 'A') {
                    layerB.innerHTML = nextHtml;
                    layerA.classList.remove('layer-visible'); layerA.classList.add('layer-hidden');
                    layerB.classList.remove('layer-hidden'); layerB.classList.add('layer-visible');
                    activeLayer = 'B';
                } else {
                    layerA.innerHTML = nextHtml;
                    layerB.classList.remove('layer-visible'); layerB.classList.add('layer-hidden');
                    layerA.classList.remove('layer-hidden'); layerA.classList.add('layer-visible');
                    activeLayer = 'A';
                }
                index++;

                // after the new layer is visible, attach listener to its button if it's the final one
                if (index === lines.length - 1) {
                    attachListenerToFinalButton();
                }
            }

            // attach click listener to the final button (present in currently visible layer)
            function attachListenerToFinalButton() {
                // button might be in either layer A or B, depending on activeLayer
                const container = (activeLayer === 'A') ? layerA : layerB;
                const btn = container.querySelector('#dynamicFinalBtn'); // ID is unique within that container
                if (btn) {
                    // remove any previous listener by replacing with clone? simpler: add event listener (avoid duplicates)
                    // but we ensure we only call this once per final display.
                    btn.replaceWith(btn.cloneNode(true)); // wipe old listeners
                    const newBtn = container.querySelector('#dynamicFinalBtn');
                    if (newBtn) {
                        newBtn.addEventListener('click', (e) => {
                            e.stopPropagation();  // prevent body click from advancing further
                            window.location.href = FINAL_REDIRECT_URL;
                        });
                    }
                }
            }

            // ---------- MUSIC PLAYER (same as before) ----------
            const audio = document.getElementById('audioPlayer');
            const playBtn = document.getElementById('playPauseBtn');
            const customPlayer = document.getElementById('customPlayer');
            const vinyl = document.getElementById('vinylDisc');
            const seekBar = document.getElementById('seekBar');
            const seekFill = document.getElementById('seekFill');
            const currentTimeSpan = document.getElementById('currentTime');
            const durationSpan = document.getElementById('durationTime');
            const songTitleSpan = document.getElementById('songTitle');
            const songArtistSpan = document.getElementById('songArtist');

            songTitleSpan.innerText = 'i love you';
            songArtistSpan.innerText = 'Billie Eilish';
            // optional cover (commented)
            // vinyl.style.backgroundImage = "url('')";

            let isPlaying = false;

            function updatePlayState() {
                if (isPlaying) {
                    playBtn.innerText = '‚è∏Ô∏é';
                    customPlayer.classList.add('playing');
                } else {
                    playBtn.innerText = '‚ñ∂';
                    customPlayer.classList.remove('playing');
                }
            }

            function togglePlay() {
                if (audio.paused) {
                    audio.play().then(() => {
                        isPlaying = true;
                        updatePlayState();
                    }).catch(e => console.log('play blocked:', e));
                } else {
                    audio.pause();
                    isPlaying = false;
                    updatePlayState();
                }
            }

            playBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                togglePlay();
            });

            audio.addEventListener('play', () => { isPlaying = true; updatePlayState(); });
            audio.addEventListener('pause', () => { isPlaying = false; updatePlayState(); });

            audio.addEventListener('loadedmetadata', () => {
                durationSpan.innerText = formatTime(audio.duration);
            });

            audio.addEventListener('timeupdate', () => {
                if (audio.duration) {
                    const percent = (audio.currentTime / audio.duration) * 100;
                    seekFill.style.width = percent + '%';
                    currentTimeSpan.innerText = formatTime(audio.currentTime);
                }
            });

            seekBar.addEventListener('click', (e) => {
                const rect = seekBar.getBoundingClientRect();
                const clickX = e.clientX - rect.left;
                const width = rect.width;
                const seekTime = (clickX / width) * audio.duration;
                audio.currentTime = seekTime;
            });

            function formatTime(seconds) {
                if (isNaN(seconds)) return '0:00';
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }

            function attemptAutoplay() {
                audio.play().then(() => {
                    isPlaying = true;
                    updatePlayState();
                }).catch(() => {
                    const startAudio = function(ev) {
                        if (ev.target.closest('.music-player')) return;
                        audio.play().then(() => {
                            isPlaying = true;
                            updatePlayState();
                            document.body.removeEventListener('click', startAudio);
                            document.body.removeEventListener('touchstart', startAudio);
                        }).catch(() => {});
                    };
                    document.body.addEventListener('click', startAudio);
                    document.body.addEventListener('touchstart', startAudio);
                });
            }
            setTimeout(attemptAutoplay, 300);

            audio.addEventListener('ended', () => {
                isPlaying = false;
                updatePlayState();
                audio.currentTime = 0;
            });

            // ---------- CLICK TO ADVANCE TEXT (ignore player) ----------
            document.body.addEventListener('click', (event) => {
                if (event.target.closest('.music-player')) return;
                // also ignore if the clicked element is the final button (its own handler will redirect)
                if (event.target.classList.contains('final-link-btn')) return;
                if (index < lines.length - 1) showNextLine();
            });

            // initial classes
            layerA.classList.add('layer-visible');
            layerB.classList.add('layer-hidden');

            // if the first line already is final (unlikely) attach button listener, but index=0 not final.
            // we'll be fine
        })();
    </script>
</body>

</html>
